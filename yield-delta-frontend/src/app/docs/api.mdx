# API Reference

Complete reference for the Yield Delta REST API. Build integrations, fetch market data, and manage vaults programmatically.

## üåê Base URL

```
https://api.yielddelta.com/api
```

**Development**: `http://localhost:3000/api`

## üîê Authentication

Most endpoints are public, but some require API key authentication:

```bash
curl -H "X-API-Key: your-api-key" \
  https://api.yielddelta.com/api/vaults
```

### Public Endpoints
- `GET /health` - Health check
- `GET /market/data` - Market data
- `GET /vaults` - List vaults
- `GET /docs` - API documentation

### Rate Limiting
- **Limit**: 100 requests per minute per IP
- **Headers**: Check `X-RateLimit-*` response headers
- **Upgrade**: Contact us for higher limits

## üìä Response Format

All API responses follow this structure:

```json
{
  "success": true,
  "data": { /* response data */ },
  "message": "Operation completed successfully",
  "timestamp": "2024-01-23T15:30:00Z",
  "chainId": 1328
}
```

### Error Responses
```json
{
  "success": false,
  "error": "Validation failed",
  "details": {
    "field": "amount",
    "message": "Must be greater than 0"
  },
  "timestamp": "2024-01-23T15:30:00Z"
}
```

## üèóÔ∏è Core Endpoints

### Health Check

Check API and service status:

```http
GET /health
```

**Response:**
```json
{
  "status": "healthy",
  "timestamp": "2024-01-23T15:30:00Z",
  "version": "1.0.0",
  "chain": "SEI",
  "chainId": 1328,
  "services": {
    "api": "operational",
    "ai_engine": "operational", 
    "blockchain": "operational"
  }
}
```

### Vaults

#### List Vaults

```http
GET /vaults?strategy=concentrated_liquidity&active=true
```

**Parameters:**
- `strategy` - Filter by vault strategy
- `active` - Show only active vaults
- `page` - Page number (default: 1)
- `limit` - Results per page (max: 1000)

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "vault_123",
      "name": "SEI-USDC Concentrated Liquidity",
      "strategy": "concentrated_liquidity",
      "address": "0x742d35Cc6634C0532925a3b8D96Df6d1e1234567",
      "tokenA": {
        "symbol": "SEI",
        "address": "0x...",
        "decimals": 18
      },
      "tokenB": {
        "symbol": "USDC", 
        "address": "0x...",
        "decimals": 6
      },
      "totalValueLocked": "1250000.50",
      "apy": "127.5",
      "fee": 0.003,
      "isActive": true,
      "performance": {
        "24h": "2.4%",
        "7d": "15.8%",
        "30d": "127.5%"
      }
    }
  ],
  "count": 1,
  "chainId": 1328
}
```

#### Create Vault

```http
POST /vaults
```

**Body:**
```json
{
  "name": "Custom Strategy Vault",
  "strategy": "concentrated_liquidity",
  "tokenA": "0x...",
  "tokenB": "0x...", 
  "fee": 0.003,
  "tickSpacing": 60
}
```

#### Get Vault Details

```http
GET /vaults/{address}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "vault": { /* vault details */ },
    "positions": [
      {
        "user": "0x...",
        "shares": "1500.0",
        "value": "1623.75",
        "unrealizedPnL": "123.75"
      }
    ],
    "analytics": {
      "totalDeposits": "50000.0",
      "totalWithdrawals": "5000.0", 
      "netFlows": "45000.0",
      "avgApy": "115.2"
    }
  }
}
```

## ü§ñ AI Endpoints

### Yield Predictions

Get AI-powered yield predictions:

```http
POST /ai/predict
```

**Body:**
```json
{
  "symbol": "SEI-USDC",
  "strategy": "concentrated_liquidity",
  "amount": 1000,
  "timeframe": "7d"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "prediction": {
      "expectedApy": "124.7",
      "confidence": 0.87,
      "optimalRange": {
        "lowerTick": -12000,
        "upperTick": 8000
      },
      "riskAssessment": {
        "impermanentLossRisk": "medium",
        "volatilityRisk": "low",
        "liquidityRisk": "low"
      }
    },
    "market": {
      "sentiment": "bullish",
      "volatility": 0.23,
      "trend": "upward"
    }
  }
}
```

### AI Rebalancing

Get rebalancing recommendations:

```http
POST /ai/rebalance
```

**Body:**
```json
{
  "vaultAddress": "0x742d35Cc6634C0532925a3b8D96Df6d1e1234567",
  "userAddress": "0x...",
  "strategy": "maximize_yield",
  "riskTolerance": "medium"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "recommendations": [
      {
        "action": "move",
        "fromVault": "SEI-USDC LP",
        "toVault": "ATOM-SEI LP", 
        "amount": 500,
        "reason": "ATOM-SEI showing 18.7% APY vs 12.4% current",
        "priority": "high",
        "estimatedGas": "0.002 SEI"
      }
    ],
    "totalActions": 3,
    "estimatedGas": "0.006 SEI",
    "potentialYieldIncrease": "4.2%"
  }
}
```

## üìà Market Data

### Real-time Market Data

```http
GET /market/data?symbols=SEI-USDC,ATOM-SEI&interval=1h
```

**Parameters:**
- `symbols` - Comma-separated trading pairs
- `interval` - Data interval (1m, 5m, 1h, 1d)
- `limit` - Number of data points (max: 1000)

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "symbol": "SEI-USDC",
      "price": 0.52,
      "change24h": 8.4,
      "volume24h": 2400000,
      "high24h": 0.54,
      "low24h": 0.48,
      "marketCap": 156000000,
      "liquidity": 8900000,
      "apy": 12.4,
      "timestamp": "2024-01-23T15:30:00Z"
    }
  ]
}
```

### Historical Data

```http
GET /market/data/history?symbol=SEI-USDC&from=2024-01-01&to=2024-01-23
```

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "timestamp": "2024-01-01T00:00:00Z",
      "open": 0.48,
      "high": 0.52,
      "low": 0.47,
      "close": 0.51,
      "volume": 1500000
    }
  ]
}
```

### Arbitrage Opportunities

```http
GET /market/arbitrage?minProfit=0.5&maxSlippage=1.0
```

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "symbol": "SEI-USDC",
      "exchanges": ["DragonSwap", "SeiSwap"],
      "prices": [0.52, 0.525],
      "profit": "0.96%",
      "volume": 50000,
      "confidence": 0.89,
      "executionRisk": "low"
    }
  ]
}
```

## üîß Utility Endpoints

### Gas Estimation

```http
POST /gas/estimate
```

**Body:**
```json
{
  "operations": ["deposit", "rebalance"],
  "amounts": [1000, 500]
}
```

### Network Status

```http
GET /network/status
```

**Response:**
```json
{
  "success": true,
  "data": {
    "chainId": 1328,
    "blockHeight": 15432890,
    "blockTime": "0.4s",
    "gasPrice": "0.001 SEI",
    "tps": 5000,
    "finalityTime": "0.4s"
  }
}
```

## üìù Code Examples

### JavaScript/TypeScript

```typescript
// Fetch vault data
const response = await fetch('https://api.yielddelta.com/api/vaults/0x742d35...');
const { data } = await response.json();

// Create vault position
const result = await fetch('https://api.yielddelta.com/api/vaults', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'your-api-key'
  },
  body: JSON.stringify({
    name: 'My Custom Vault',
    strategy: 'concentrated_liquidity',
    tokenA: '0x...',
    tokenB: '0x...'
  })
});
```

### Python

```python
import requests

# Get market data
response = requests.get('https://api.yielddelta.com/api/market/data')
data = response.json()

# AI prediction
prediction = requests.post('https://api.yielddelta.com/api/ai/predict', 
  json={
    'symbol': 'SEI-USDC',
    'strategy': 'concentrated_liquidity',
    'amount': 1000
  }
)
```

### cURL

```bash
# Health check
curl https://api.yielddelta.com/api/health

# Get vaults with filtering
curl "https://api.yielddelta.com/api/vaults?strategy=concentrated_liquidity&active=true"

# Create vault (authenticated)
curl -X POST https://api.yielddelta.com/api/vaults \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{"name":"Test Vault","strategy":"concentrated_liquidity"}'
```

## üêõ Error Codes

| Code | Description | Solution |
|------|-------------|----------|
| `400` | Bad Request | Check request parameters |
| `401` | Unauthorized | Include valid API key |
| `403` | Forbidden | Check API key permissions |
| `404` | Not Found | Verify endpoint URL |
| `429` | Rate Limited | Reduce request frequency |
| `500` | Internal Error | Contact support |

## üìö SDKs & Tools

### Official SDKs
- **TypeScript**: `@seidlp/sdk` (coming soon)
- **Python**: `seidlp-python` (coming soon)
- **Go**: `go-seidlp` (coming soon)

### Community Tools
- **Postman Collection**: Import our API collection
- **OpenAPI Spec**: Available at `/api/openapi.json`
- **GraphQL**: GraphQL endpoint at `/api/graphql`

---

*Need help? Join our [Discord](https://discord.gg/sei) or check the [troubleshooting guide](/docs/troubleshooting).*