# Liqui Backend Deployment Guide

This guide covers deploying the Liqui ElizaOS backend service to Render.

## Quick Deployment Steps

### 1. Database Setup
- Create a PostgreSQL database in Render dashboard
- Note the connection string for environment variables

### 2. Environment Variables
Set these **required** environment variables in Render dashboard:

#### Database
- `DATABASE_URL` - PostgreSQL connection string (auto-generated by Render)

#### AI Model Providers (at least one required)
- `OPENAI_API_KEY` - OpenAI API key for GPT models
- `ANTHROPIC_API_KEY` - Anthropic API key for Claude models  
- `GOOGLE_GENERATIVE_AI_API_KEY` - Google AI API key

#### SEI Blockchain Wallet
- `SEI_PRIVATE_KEY` - Your SEI wallet private key (64 chars, no 0x prefix)
- `SEI_ADDRESS` - Your SEI wallet address

### 3. Deploy Configuration
- Runtime: Node.js
- Build Command: `npm ci && npm run build`
- Start Command: `npm start`
- Auto-Deploy: Disabled (manual deployment recommended)

## Memory Optimization Features

### Build Process Optimizations
- **Memory Allocation**: Increased to 4GB for build, 1GB for runtime
- **Incremental TypeScript**: Faster subsequent builds
- **Code Splitting**: Reduced bundle sizes
- **External Dependencies**: Major dependencies externalized

### Database Connection
- **ElizaOS Integration**: Uses `DATABASE_URL` environment variable
- **Fallback SQLite**: Local SQLite if PostgreSQL unavailable
- **Connection Logging**: Clear database status logging

## Configuration Files

### `render.yaml`
Auto-deployment configuration with:
- PostgreSQL database linking
- Memory-optimized settings
- Required environment variables
- Health check endpoint

### `.env.production`
Production environment template with:
- All required variables documented
- Security notes for sensitive data
- Default production values

## Build Scripts

### Optimized Build Process
```bash
npm run build          # Full optimized build with memory allocation
npm run build:check    # TypeScript type checking only
npm run build:frontend # Vite frontend build only  
npm run build:server   # tsup server build only
```

## Troubleshooting

### Memory Issues
- Build process uses 4GB Node.js heap
- Runtime limited to 1GB for efficiency
- Incremental TypeScript compilation

### Database Connection
- Check `DATABASE_URL` format: `postgresql://user:pass@host:port/db`
- Verify PostgreSQL database is running
- Check logs for connection status

### Missing Dependencies
- Ensure all AI provider API keys are set
- Verify SEI wallet configuration
- Check blockchain network connectivity

## Security Notes

### Environment Variables
- Never commit API keys to version control
- Use Render's environment variable encryption
- Rotate keys regularly

### Database Access
- Use strong PostgreSQL passwords
- Enable SSL connections in production
- Regular database backups

## Performance Monitoring

### Logging
- Application logs available in Render dashboard
- Database connection status logged on startup
- AI model provider status verification

### Health Checks
- ElizaOS server provides health endpoints
- Database connectivity monitoring
- Automatic restart on failures

## Support

For deployment issues:
1. Check Render build logs for specific errors
2. Verify all required environment variables are set
3. Ensure PostgreSQL database is accessible
4. Contact support with specific error messages